---
phase: 06-mobile-responsiveness
plan: 03
type: execute
wave: 2
depends_on: ["06-01"]
files_modified:
  - components/ConfigDialog.jsx
  - components/TimerOverlay.jsx
autonomous: true

must_haves:
  truths:
    - "ConfigDialog renders as bottom drawer on mobile (<640px) with swipe-to-dismiss"
    - "ConfigDialog renders as centered modal on tablet/desktop (640px+)"
    - "ConfigDialog bottom drawer has visible swipe handle and close button"
    - "TimerOverlay uses full-screen layout with dvh on mobile"
    - "TimerOverlay buttons meet 44px touch target minimum"
    - "Settings dialog is responsive at mobile/tablet/desktop breakpoints"
  artifacts:
    - path: "components/ConfigDialog.jsx"
      provides: "Responsive dialog with bottom drawer on mobile"
      contains: "useSwipeable"
    - path: "components/TimerOverlay.jsx"
      provides: "Full-screen mobile timer with large touch targets"
      contains: "min-h-[44px]"
  key_links:
    - from: "components/ConfigDialog.jsx"
      to: "react-swipeable"
      via: "useSwipeable hook import"
      pattern: "import.*useSwipeable.*react-swipeable"
    - from: "components/ConfigDialog.jsx"
      to: "egg-calculator.jsx"
      via: "visible/onClose props"
      pattern: "visible.*onClose"
    - from: "components/TimerOverlay.jsx"
      to: "egg-calculator.jsx"
      via: "timer state props"
      pattern: "timerActive.*timerComplete"
---

<objective>
Transform ConfigDialog into a responsive bottom drawer on mobile with swipe-to-dismiss, and enhance TimerOverlay for immersive full-screen mobile experience.

Purpose: The ConfigDialog is currently a fixed-position centered modal that works on desktop but is awkward on mobile. Converting it to a bottom drawer on mobile follows native mobile patterns (iOS action sheets). The TimerOverlay needs mobile optimization for an immersive cooking experience with large touch targets.

Output: ConfigDialog is a swipeable bottom drawer on mobile and centered modal on desktop. TimerOverlay is fully immersive on mobile.
</objective>

<execution_context>
@/Users/beff/.claude/get-shit-done/workflows/execute-plan.md
@/Users/beff/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/06-mobile-responsiveness/06-CONTEXT.md
@.planning/phases/06-mobile-responsiveness/06-RESEARCH.md
@components/ConfigDialog.jsx
@components/TimerOverlay.jsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Convert ConfigDialog to bottom drawer on mobile</name>
  <files>components/ConfigDialog.jsx</files>
  <action>
Rewrite ConfigDialog to be a bottom drawer on mobile (<640px) and centered modal on tablet/desktop (640px+). The component keeps the SAME props interface -- no changes to how the parent calls it.

**Implementation approach:**

1. Import `useSwipeable` from `react-swipeable`:
   ```jsx
   import { useSwipeable } from 'react-swipeable';
   ```

2. Add swipe handler inside the component:
   ```jsx
   const swipeHandlers = useSwipeable({
     onSwipedDown: (eventData) => {
       if (eventData.velocity > 0.5) onClose();
     },
     preventScrollOnSwipe: true,
     trackTouch: true,
     trackMouse: false,
   });
   ```

3. Replace the current dialog structure with responsive layout:

   **Backdrop:** Keep as-is (fixed inset-0 bg-black/50).

   **Dialog container:** Two layouts using Tailwind responsive:
   ```jsx
   <div
     {...swipeHandlers}
     className={`
       fixed z-50 bg-white shadow-2xl
       inset-x-0 bottom-0 rounded-t-2xl max-h-[90vh]
       sm:inset-auto sm:top-1/2 sm:left-1/2 sm:-translate-x-1/2 sm:-translate-y-1/2
       sm:rounded-2xl sm:w-80 sm:max-w-[90vw] sm:max-h-none
     `}
   >
   ```
   Mobile (base): Fixed to bottom, full width, rounded top corners, max 90vh height.
   Desktop (sm:): Centered modal as before, w-80 with rounded corners.

4. **Mobile swipe handle** (visible only on mobile):
   ```jsx
   <div className="sm:hidden flex justify-center pt-3 pb-1">
     <div className="w-12 h-1.5 bg-gray-300 rounded-full" />
   </div>
   ```

5. **Scrollable content area:**
   ```jsx
   <div className="overflow-y-auto max-h-[calc(90vh-3rem)] sm:max-h-none p-6">
   ```
   This allows scrolling within the drawer on mobile if content overflows.

6. **Close button:** Already exists. Add `min-h-[44px] min-w-[44px]` for touch target:
   ```jsx
   <button onClick={onClose} className="p-2 min-h-[44px] min-w-[44px] hover:bg-gray-100 rounded-lg transition-colors text-gray-500 hover:text-gray-700 flex items-center justify-center">
   ```

7. **Unit toggle buttons:** Add `min-h-[44px]` to each:
   ```jsx
   <button ... className="w-full px-3 py-2 min-h-[44px] bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors text-sm font-medium">
   ```

8. **Language grid** (line ~115): Change `grid-cols-2` to `grid-cols-3 sm:grid-cols-2` -- 3 columns on mobile (6 languages = 2 rows, fits nicely), 2 columns on desktop (current). Add `min-h-[44px]` to each language button:
   ```jsx
   <div className="grid grid-cols-3 gap-2 sm:grid-cols-2">
   ```
   ```jsx
   <button ... className={`p-2 min-h-[44px] rounded-lg border-2 transition-all text-sm ${...}`}>
   ```

9. **Body scroll lock** when dialog is open (add useEffect):
   ```jsx
   React.useEffect(() => {
     if (visible) {
       document.body.style.overflow = 'hidden';
       return () => { document.body.style.overflow = ''; };
     }
   }, [visible]);
   ```

**Key constraint:** Do NOT change the props interface. The parent (egg-calculator.jsx) passes `visible`, `onClose`, and all the unit/language props. Keep these exactly the same.
  </action>
  <verify>
    - Run `npm run build` to verify build succeeds
    - Run `npm test` to verify all tests pass
    - Verify import of `useSwipeable` resolves correctly
  </verify>
  <done>ConfigDialog renders as bottom drawer on mobile (anchored to bottom, full width, swipe handle, swipe-to-dismiss) and centered modal on desktop (sm: breakpoint). All buttons meet 44px touch target. Body scroll locked when open.</done>
</task>

<task type="auto">
  <name>Task 2: Optimize TimerOverlay for immersive mobile experience</name>
  <files>components/TimerOverlay.jsx</files>
  <action>
Enhance TimerOverlay for a fully immersive mobile experience. The timer should feel like a dedicated screen on mobile.

**Changes:**

1. **Backdrop:** Change from `bg-opacity-70` to full background with gradient on mobile. The overlay container itself should fill the screen:
   ```jsx
   {/* Remove separate backdrop div */}
   {/* Make the overlay itself the full-screen background */}
   <div className="fixed inset-0 z-50 flex items-center justify-center bg-gradient-to-br from-amber-900/95 to-orange-900/95 p-4 sm:p-8">
   ```
   This replaces both the backdrop and the inner container approach. The white card stays inside for content.

   Actually, the simpler approach is to keep the current 2-div structure but improve it:
   - Backdrop: Keep `fixed inset-0 bg-black bg-opacity-70 z-50`
   - Inner container: `fixed inset-0 z-50 flex items-center justify-center p-4`
   - Card: Responsive sizing for the white card

2. **Timer card:** Make it more immersive on mobile:
   ```jsx
   <div className="bg-white rounded-3xl shadow-2xl p-6 sm:p-8 w-full max-w-sm text-center">
   ```

3. **Timer complete state:**
   - Emoji: Fine as-is (`text-6xl`)
   - Heading: Fine as-is (`text-2xl`)
   - Dismiss button: Increase touch target:
     ```jsx
     <button onClick={onDismiss} className="w-full py-4 min-h-[56px] px-6 bg-amber-500 text-white text-lg font-bold rounded-xl shadow-lg hover:bg-amber-600 active:scale-95 transition-all">
     ```

4. **Timer running state:**
   - Countdown text: Larger on mobile, since it's the hero element:
     ```jsx
     <div className="text-6xl sm:text-7xl font-bold text-amber-900 tabular-nums tracking-wider mb-6 sm:mb-8">
     ```
   - Control buttons: Increase size for easy tapping:
     ```jsx
     {/* Pause/Resume */}
     <button ... className={`flex-1 py-4 min-h-[56px] px-4 sm:px-6 text-base sm:text-lg font-bold rounded-xl shadow-lg transition-all active:scale-95 ${...}`}>

     {/* Stop */}
     <button onClick={onStop} className="flex-1 py-4 min-h-[56px] px-4 sm:px-6 bg-red-500 text-white text-base sm:text-lg font-bold rounded-xl shadow-lg hover:bg-red-600 active:scale-95 transition-all">
     ```

5. **Body scroll lock** when overlay is active:
   ```jsx
   React.useEffect(() => {
     if (timerActive || timerComplete) {
       document.body.style.overflow = 'hidden';
       return () => { document.body.style.overflow = ''; };
     }
   }, [timerActive, timerComplete]);
   ```

6. Add `active:scale-95` to all buttons for touch feedback.

**Key constraint:** Keep the exact same props interface. Do NOT change any logic, just className strings and minor structural JSX adjustments for layout.
  </action>
  <verify>
    - Run `npm run build` to verify build succeeds
    - Run `npm test` to verify all tests pass
  </verify>
  <done>TimerOverlay is immersive on mobile with larger countdown text, 56px minimum touch targets on control buttons, active:scale-95 touch feedback, body scroll locked when active. Desktop appearance preserved at sm: breakpoint.</done>
</task>

</tasks>

<verification>
- `npm run build` succeeds
- `npm test` passes (all 218 tests)
- ConfigDialog has `useSwipeable` import and swipe-down handler
- ConfigDialog has responsive layout (bottom drawer mobile, centered modal desktop)
- TimerOverlay has larger control buttons with min-h-[56px]
- Both components lock body scroll when visible
- Both components have touch feedback (active:scale-95)
</verification>

<success_criteria>
- ConfigDialog works as bottom drawer on mobile (<640px) with swipe handle and swipe-to-dismiss
- ConfigDialog works as centered modal on tablet/desktop (640px+)
- TimerOverlay is fully immersive on mobile with large touch targets
- All buttons meet minimum 44px (56px for primary actions) touch target
- Body scroll prevented when overlays are active
- All tests pass, build succeeds
</success_criteria>

<output>
After completion, create `.planning/phases/06-mobile-responsiveness/06-03-SUMMARY.md`
</output>
