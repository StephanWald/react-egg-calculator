---
phase: 05-component-extraction
plan: 03
type: execute
wave: 1
depends_on: []
files_modified:
  - components/SettingsPanel.jsx
  - components/LocationPressure.jsx
  - components/EggInputs.jsx
  - components/ResultDisplay.jsx
autonomous: true

must_haves:
  truths:
    - "SettingsPanel renders stove type, power, pot material/weight, and temperature controls"
    - "LocationPressure renders GPS button, pressure input, boiling point, altitude, and location name"
    - "EggInputs renders egg count, water volume, egg size, and start temperature controls"
    - "ResultDisplay renders egg visualization, cooking time, temp drop warning, timer countdown, and start/stop button"
  artifacts:
    - path: "components/SettingsPanel.jsx"
      provides: "Household settings panel component"
      exports: ["SettingsPanel"]
    - path: "components/LocationPressure.jsx"
      provides: "GPS and pressure section component"
      exports: ["LocationPressure"]
    - path: "components/EggInputs.jsx"
      provides: "Egg parameter input controls component"
      exports: ["EggInputs"]
    - path: "components/ResultDisplay.jsx"
      provides: "Cooking result display with timer button"
      exports: ["ResultDisplay"]
  key_links:
    - from: "components/SettingsPanel.jsx"
      to: "constants.js"
      via: "import STOVE_TYPES, POT_MATERIALS"
      pattern: "import.*STOVE_TYPES.*POT_MATERIALS"
    - from: "components/SettingsPanel.jsx"
      to: "formatters.js"
      via: "import formatTemp"
      pattern: "import.*formatTemp"
    - from: "components/LocationPressure.jsx"
      to: "formatters.js"
      via: "import formatTemp, formatPressure"
      pattern: "import.*formatTemp.*formatPressure"
    - from: "components/EggInputs.jsx"
      to: "constants.js"
      via: "import EGG_SIZES, START_TEMP_OPTIONS"
      pattern: "import.*EGG_SIZES.*START_TEMP_OPTIONS"
    - from: "components/ResultDisplay.jsx"
      to: "formatters.js"
      via: "import formatTime, formatCountdown"
      pattern: "import.*formatTime.*formatCountdown"
---

<objective>
Extract SettingsPanel, LocationPressure, EggInputs, and ResultDisplay from egg-calculator.jsx into standalone presentational components.

Purpose: These four components are the remaining UI sections. SettingsPanel is the largest (~152 lines of JSX), LocationPressure handles GPS/pressure (~55 lines), EggInputs has egg parameter controls (~93 lines), and ResultDisplay shows results with timer button (~50 lines). Together they account for ~350 lines of JSX.
Output: Four new component files in components/ directory, each receiving all data via props.
</objective>

<execution_context>
@/Users/beff/.claude/get-shit-done/workflows/execute-plan.md
@/Users/beff/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@egg-calculator.jsx
@constants.js
@formatters.js
@useTranslation.js
</context>

<tasks>

<task type="auto">
  <name>Task 1: Extract SettingsPanel and LocationPressure components</name>
  <files>components/SettingsPanel.jsx, components/LocationPressure.jsx</files>
  <action>
**SettingsPanel** (components/SettingsPanel.jsx):
Extract the settings panel content from egg-calculator.jsx.

**Locating the JSX (content-based -- do NOT rely on line numbers):**
Read egg-calculator.jsx and find the settings panel section. Search for the comment `{/* ============ SETTINGS PANEL ============ */}` followed by `{showSettings && (`. The panel content starts with `<div className="bg-white rounded-2xl shadow-xl p-6 mb-4">` containing `{t('settingsTitle')}`. It includes: stove type grid, stove power slider, pot material/weight section, water/ambient temperature section with cold weather warning, and reset button. The section ends at the closing `</div>` of the panel and the closing `)}` of the conditional, just before the `{/* ============ MAIN CARD ============ */}` comment. Currently around lines 454-608 but line numbers may shift.

The component renders the panel content only -- the parent controls visibility via conditional rendering.

Props:
- `stoveType` (string): Current stove type ID
- `stovePower` (number): Current stove power in watts
- `stoveEfficiency` (number): Current stove efficiency (0-1)
- `potMaterial` (string): Current pot material ID
- `potWeight` (number): Current pot weight in kg
- `waterStartTemp` (number): Water start temperature in Celsius
- `ambientTemp` (number): Ambient temperature in Celsius
- `tempUnit` (string): Temperature display unit
- `onStoveTypeChange` (function): Callback with stove type ID (handleStoveTypeChange)
- `onStovePowerChange` (function): Callback with power number (updateSetting('stovePower', value))
- `onPotMaterialChange` (function): Callback with material ID
- `onPotWeightChange` (function): Callback with weight number
- `onWaterStartTempChange` (function): Callback with temp number
- `onAmbientTempChange` (function): Callback with temp number
- `onResetToDefaults` (function): Reset handler (handleResetToDefaults -- called after confirm dialog)

The component calls `useTranslation()` for `t()`. Imports `STOVE_TYPES`, `POT_MATERIALS` from `../constants` and `formatTemp` from `../formatters`.

IMPORTANT: The reset button contains a `window.confirm` call. Keep this logic in the component -- it calls `onResetToDefaults()` only if confirmed.

IMPORTANT: The cold weather warning `{ambientTemp < 10 && stoveEfficiency < 0.6 && ...}` needs both `ambientTemp` and `stoveEfficiency` props.

Copy JSX exactly. Export as named export.

**LocationPressure** (components/LocationPressure.jsx):
Extract the location & pressure section from egg-calculator.jsx.

**Locating the JSX (content-based):**
Search for the comment `{/* Location & Pressure Section */}` inside the MAIN CARD. The section starts with `<div className="mb-5 p-4 bg-gradient-to-r from-sky-50 to-blue-50 rounded-xl border border-sky-200">` containing `{t('locationPressure')}`. It includes the GPS button, error display, pressure/boilingPoint/altitude grid, location name, and pressure source indicator. The section ends at the closing `</div>` of the sky-gradient wrapper, just before the `{/* Consistency Selection */}` comment. Currently around lines 664-719 but line numbers may shift.

Props:
- `pressure` (number): Current pressure in hPa
- `boilingPoint` (number): Current boiling point in Celsius
- `altitude` (number): Current altitude in meters
- `locationName` (string|null): Current location name
- `locationLoading` (boolean): Whether GPS is loading
- `locationError` (string|null): Error code from location hook
- `pressureSource` (string): Source of pressure data ('default', 'gps', 'manual')
- `tempUnit` (string): Temperature display unit
- `pressureUnit` (string): Pressure display unit
- `onGetLocation` (function): GPS detect callback (getLocationAndPressure)
- `onPressureChange` (function): Manual pressure change callback (handleManualPressure)
- `locationErrorMessage` (string|null): Pre-translated error message (from getLocationErrorMessage)

NOTE: The error code-to-message translation happens in the parent (EggCalculator) because hooks return error codes, and the parent maps them via `getLocationErrorMessage()`. Pass the translated message as `locationErrorMessage` prop rather than the error code.

Imports `useTranslation`, `formatTemp` and `formatPressure` from `../formatters`.

Copy JSX exactly. Export as named export. Add JSDoc.
  </action>
  <verify>Both files exist with named exports. SettingsPanel imports STOVE_TYPES, POT_MATERIALS, formatTemp. LocationPressure imports formatTemp, formatPressure. JSDoc present on both.</verify>
  <done>SettingsPanel.jsx and LocationPressure.jsx created with exact JSX, proper props interfaces, and all necessary imports.</done>
</task>

<task type="auto">
  <name>Task 2: Extract EggInputs and ResultDisplay components</name>
  <files>components/EggInputs.jsx, components/ResultDisplay.jsx</files>
  <action>
**EggInputs** (components/EggInputs.jsx):
Extract the egg input controls from egg-calculator.jsx.

**Locating the JSX (content-based -- do NOT rely on line numbers):**
Search for the comment `{/* Egg Count & Water Volume */}` inside the MAIN CARD. The section starts with `<div className="grid grid-cols-2 gap-4 mb-5">` containing egg count buttons and water volume slider. It continues through the `{/* Egg Size */}` section (EGG_SIZES grid + weight slider) and the `{/* Start Temperature */}` section (START_TEMP_OPTIONS grid). The section ends at the closing `</div>` of the start temperature `mb-5` wrapper, just before the `{/* Important Notices */}` comment. Currently around lines 743-835 but line numbers may shift.

Props:
- `eggCount` (number): Current egg count
- `waterVolume` (number): Current water volume in liters
- `weight` (number): Current egg weight in grams
- `startTemp` (number): Current start temperature in Celsius
- `tempUnit` (string): Temperature display unit
- `volumeUnit` (string): Volume display unit
- `weightUnit` (string): Weight display unit
- `onEggCountChange` (function): Callback with count number
- `onWaterVolumeChange` (function): Callback with volume number
- `onWeightChange` (function): Callback with weight number
- `onStartTempChange` (function): Callback with temp number

Imports `useTranslation`, `EGG_SIZES` and `START_TEMP_OPTIONS` from `../constants`, `formatTemp`, `formatVolume`, `formatWeight` from `../formatters`.

Copy JSX exactly. Export as named export.

**ResultDisplay** (components/ResultDisplay.jsx):
Extract the result display section from egg-calculator.jsx.

**Locating the JSX (content-based):**
Search for the comment `{/* Result Display */}` inside the MAIN CARD. The section starts with `<div className="flex flex-col items-center mb-6">` containing the egg visualization SVG, cooking time display, ideal time comparison, temperature drop warning, timer countdown inline display, and start/stop timer button. The section ends at the closing `</div>` of the `flex flex-col items-center mb-6` wrapper, just before the `{/* Location & Pressure Section */}` comment. Currently around lines 613-662 but line numbers may shift.

Props:
- `cookingTime` (number|null): Calculated cooking time in minutes
- `idealTime` (number|null): Ideal cooking time without adjustments
- `tempDrop` (number|null): Temperature drop in Celsius
- `effectiveTemp` (number|null): Effective cooking temperature
- `consistency` (string): Current consistency ID
- `tempUnit` (string): Temperature display unit
- `timerActive` (boolean): Whether timer is running
- `timerRemaining` (number|null): Seconds remaining
- `onStartTimer` (function): Start timer callback (handleStartTimer)
- `onStopTimer` (function): Stop timer callback (handleStopTimer)

The `getEggVisualization()` function (search for `const getEggVisualization` in egg-calculator.jsx -- it's a local function that renders an SVG using `consistency` and `CONSISTENCY_OPTIONS`) should be moved INTO this component as a local function or inline JSX. It uses `consistency` and `CONSISTENCY_OPTIONS` to render the SVG.

Imports `useTranslation`, `CONSISTENCY_OPTIONS` from `../constants`, `formatTime`, `formatCountdown`, `formatTemp` from `../formatters`.

IMPORTANT for temp drop display: The inline Fahrenheit conversion `tempUnit === 'F' ? Math.round(tempDrop * 9 / 5) : tempDrop` must be preserved exactly as-is. Do NOT replace it with formatTemp (it's not a full temperature, it's a delta).

Copy JSX exactly. Export as named export. Add JSDoc.
  </action>
  <verify>Both files exist with named exports. EggInputs imports EGG_SIZES, START_TEMP_OPTIONS, formatTemp, formatVolume, formatWeight. ResultDisplay imports CONSISTENCY_OPTIONS, formatTime, formatCountdown, formatTemp. JSDoc present on both.</verify>
  <done>EggInputs.jsx and ResultDisplay.jsx created with exact JSX, getEggVisualization moved into ResultDisplay, and all necessary imports.</done>
</task>

</tasks>

<verification>
- `ls components/SettingsPanel.jsx components/LocationPressure.jsx components/EggInputs.jsx components/ResultDisplay.jsx` -- all exist
- Each file has a named export matching the filename
- No hook calls except useTranslation in each component
- All constants/formatters imported from correct relative paths (../)
- JSDoc present on each component
</verification>

<success_criteria>
- 4 component files created in components/ directory
- Each component is presentational (props + useTranslation only)
- JSX copied exactly from egg-calculator.jsx without modification (except getEggVisualization moving into ResultDisplay)
- All imports correct (useTranslation, constants, formatters)
- Components ready for integration in Plan 04
</success_criteria>

<output>
After completion, create `.planning/phases/05-component-extraction/05-03-SUMMARY.md`
</output>
